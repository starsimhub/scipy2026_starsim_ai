{"problem_id": "starsim_t3", "sub_step_id": "starsim_t3.1", "description": "Create and run an SIR simulation that includes vital dynamics (births and deaths) using the parameters dictionary approach. Add demographic rates alongside disease and network parameters so that the population size changes over time due to births and deaths, and agents age during the simulation.", "function_header": "def create_sir_with_demographics(n_agents: int = 5_000, birth_rate: float = 20, death_rate: float = 15, beta: float = 0.05, init_prev: float = 0.01) -> ss.Sim:", "docstring": "Create and run an SIR simulation with birth and death dynamics.\n\nUse a parameters dictionary that includes birth_rate, death_rate,\na random contact network, and SIR disease. The simulation should\nrun from 2020 to 2040.\n\nArgs:\n    n_agents: Number of agents to simulate.\n    birth_rate: Crude birth rate (per 1000 people per year).\n    death_rate: Crude death rate (per 1000 people per year).\n    beta: Probability of transmission between contacts.\n    init_prev: Initial proportion of the population that is infected.\n\nReturns:\n    A Starsim Sim object that has been run to completion.", "background": "In basic epidemic models, the population is often fixed — no one is born or dies from non-disease causes. Adding demographics (births and deaths) makes the model more realistic for longer-term projections. In Starsim, specifying birth_rate and death_rate in the parameters dictionary automatically creates Births and Deaths demographic modules. When demographics modules are present, agents also age over time (use_aging becomes True).", "dependencies": ["starsim"], "test_cases": [{"description": "Simulation should have births and deaths demographic modules", "test": "sim = create_sir_with_demographics()\nassert hasattr(sim.demographics, 'births'), 'Simulation should have a births demographic module'\nassert hasattr(sim.demographics, 'deaths'), 'Simulation should have a deaths demographic module'"}, {"description": "Simulation should have an SIR disease", "test": "sim = create_sir_with_demographics()\nassert hasattr(sim.diseases, 'sir'), 'Simulation should have an SIR disease'"}, {"description": "Agents should age during the simulation", "test": "sim = create_sir_with_demographics()\nassert sim.pars.use_aging is True, 'Agents should age when demographics are included'"}, {"description": "Simulation should produce infections", "test": "sim = create_sir_with_demographics()\nassert sim.results.sir.cum_infections[-1] > 0, 'There should be at least some infections'"}, {"description": "Results should include birth and death tracking", "test": "sim = create_sir_with_demographics()\nassert 'births' in sim.results, 'Results should track births'\nassert 'new_deaths' in sim.results, 'Results should track deaths'"}], "gold_solution": "def create_sir_with_demographics(n_agents: int = 5_000, birth_rate: float = 20, death_rate: float = 15, beta: float = 0.05, init_prev: float = 0.01) -> ss.Sim:\n    import starsim as ss\n    pars = dict(\n        n_agents=n_agents,\n        birth_rate=birth_rate,\n        death_rate=death_rate,\n        networks='random',\n        diseases=dict(type='sir', init_prev=init_prev, beta=beta),\n        start=2020,\n        stop=2040,\n    )\n    sim = ss.Sim(pars)\n    sim.run()\n    return sim"}
{"problem_id": "starsim_t3", "sub_step_id": "starsim_t3.2", "description": "Create a simulation with demographics using the component-based approach. Instantiate ss.Births and ss.Deaths objects explicitly and pass them via the demographics parameter, along with component-based disease and network objects. This approach provides more flexibility for configuring demographic modules.", "function_header": "def create_component_demographics(n_agents: int = 5_000, birth_rate: float = 20, death_rate: float = 15, beta: float = 0.05, init_prev: float = 0.01) -> ss.Sim:", "docstring": "Create and run an SIR simulation with demographics using the component-based approach.\n\nInstantiate ss.Births, ss.Deaths, ss.SIR, ss.RandomNet, and ss.People\nobjects explicitly and pass them to ss.Sim. The simulation should run\nfrom 2020 to 2040.\n\nArgs:\n    n_agents: Number of agents to simulate.\n    birth_rate: Crude birth rate (per 1000 people per year).\n    death_rate: Crude death rate (per 1000 people per year).\n    beta: Probability of transmission between contacts.\n    init_prev: Initial proportion of the population that is infected.\n\nReturns:\n    A Starsim Sim object that has been run to completion.", "background": "Just as diseases and networks can be configured using component objects (Tutorial 2), demographic modules can also be created as explicit objects. ss.Births(birth_rate=...) and ss.Deaths(death_rate=...) are passed as a list to the demographics parameter of ss.Sim. This is preferred for complex models where you need fine-grained control over each module.", "dependencies": ["starsim"], "test_cases": [{"description": "Births module should be an ss.Births instance", "test": "import starsim as ss\nsim = create_component_demographics()\nbirths_mod = list(sim.demographics.values())[0]\nassert isinstance(births_mod, ss.Births), 'Births module should be an ss.Births instance'"}, {"description": "Deaths module should be an ss.Deaths instance", "test": "import starsim as ss\nsim = create_component_demographics()\ndeaths_mod = list(sim.demographics.values())[1]\nassert isinstance(deaths_mod, ss.Deaths), 'Deaths module should be an ss.Deaths instance'"}, {"description": "Disease should be an ss.SIR instance", "test": "import starsim as ss\nsim = create_component_demographics()\ndisease = list(sim.diseases.values())[0]\nassert isinstance(disease, ss.SIR), 'Disease should be an ss.SIR instance'"}, {"description": "Population size should change due to demographics", "test": "sim = create_component_demographics()\ninitial = sim.results.n_alive[0]\nfinal = sim.results.n_alive[-1]\nassert initial != final, 'Population should change over time with demographics'"}], "gold_solution": "def create_component_demographics(n_agents: int = 5_000, birth_rate: float = 20, death_rate: float = 15, beta: float = 0.05, init_prev: float = 0.01) -> ss.Sim:\n    import starsim as ss\n    people = ss.People(n_agents=n_agents)\n    births = ss.Births(birth_rate=birth_rate)\n    deaths = ss.Deaths(death_rate=death_rate)\n    sir = ss.SIR(init_prev=init_prev, beta=beta)\n    network = ss.RandomNet()\n    sim = ss.Sim(people=people, diseases=sir, networks=network, demographics=[births, deaths], start=2020, stop=2040)\n    sim.run()\n    return sim"}
{"problem_id": "starsim_t3", "sub_step_id": "starsim_t3.3", "description": "Project the population of Niger from 2020 to 2040. Niger has a crude birth rate of 45 per 1000 and a crude death rate of 9 per 1000. Assuming these rates stay constant and starting with a total population of 24 million, use Starsim's total_pop parameter to scale the simulation results and return the projected population in millions.", "function_header": "def project_niger_population(total_pop: float = 24e6, birth_rate: float = 45, death_rate: float = 9, start: int = 2020, stop: int = 2040) -> float:", "docstring": "Project Niger's population using Starsim demographic modeling.\n\nCreate a simulation with the given birth and death rates. Use the\ntotal_pop parameter to scale the simulation (which runs with a smaller\nnumber of agents) to represent the full population. Do not include\nany diseases in the model.\n\nArgs:\n    total_pop: Total population to scale results to.\n    birth_rate: Crude birth rate (per 1000 people per year).\n    death_rate: Crude death rate (per 1000 people per year).\n    start: Start year of the simulation.\n    stop: End year of the simulation.\n\nReturns:\n    Projected population at the end of the simulation, in millions\n    (e.g., 49.5 means 49.5 million).", "background": "Starsim's total_pop parameter enables statistical scaling: the simulation runs with a manageable number of agents but reports results scaled to represent a much larger population. This is useful for national-level projections where simulating every individual would be computationally prohibitive. With a net growth rate of 36 per 1000 (birth rate minus death rate), Niger's population grows rapidly.", "dependencies": ["starsim"], "test_cases": [{"description": "Projected population should be approximately 49-51 million", "test": "result = project_niger_population()\nassert 45 < result < 55, f'Population should be roughly 49-51 million, got {result:.1f}'"}, {"description": "Return value should be a float representing millions", "test": "result = project_niger_population()\nassert isinstance(result, float), 'Should return a float'"}, {"description": "Higher birth rate should produce larger population", "test": "low = project_niger_population(birth_rate=20)\nhigh = project_niger_population(birth_rate=45)\nassert high > low, 'Higher birth rate should produce a larger population'"}, {"description": "Population should grow when birth rate exceeds death rate", "test": "result = project_niger_population()\nassert result > 24, 'Population should grow beyond the initial 24 million'"}], "gold_solution": "def project_niger_population(total_pop: float = 24e6, birth_rate: float = 45, death_rate: float = 9, start: int = 2020, stop: int = 2040) -> float:\n    import starsim as ss\n    pars = dict(\n        start=start,\n        stop=stop,\n        total_pop=total_pop,\n        birth_rate=birth_rate,\n        death_rate=death_rate,\n    )\n    sim = ss.Sim(pars)\n    sim.run()\n    return float(sim.results.n_alive[-1] / 1e6)"}
{"problem_id": "starsim_t3", "sub_step_id": "starsim_t3.4", "description": "Compare how disease dynamics differ with and without demographic processes. Run two SIR simulations over a 20-year period — one without demographics (fixed population) and one with births and deaths — and return key outcome metrics from each. This illustrates how population turnover affects long-term epidemic dynamics.", "function_header": "def compare_demographics_impact(n_agents: int = 5_000, birth_rate: float = 20, death_rate: float = 10, beta: float = 0.05, init_prev: float = 0.01) -> dict[str, dict]:", "docstring": "Compare SIR dynamics with and without demographic processes.\n\nRun two simulations from 2020 to 2040:\n1. 'no_demographics': SIR with a random network, no births/deaths\n2. 'with_demographics': SIR with a random network plus births and deaths\n\nArgs:\n    n_agents: Number of agents to simulate.\n    birth_rate: Crude birth rate (per 1000 per year), used only in the demographics sim.\n    death_rate: Crude death rate (per 1000 per year), used only in the demographics sim.\n    beta: Probability of transmission between contacts.\n    init_prev: Initial proportion of the population that is infected.\n\nReturns:\n    Dictionary with two keys ('no_demographics', 'with_demographics'),\n    each mapping to a dict containing:\n        - 'final_pop': number of living agents at the end of the simulation\n        - 'cum_infections': cumulative SIR infections at end of simulation", "background": "Without demographics, a population is closed — no new susceptible individuals enter (via birth) and no one leaves (via non-disease death). In an SIR model, this means the epidemic burns through the susceptible pool and dies out permanently. With demographics, new births continuously replenish the susceptible pool, which can sustain or reignite transmission over longer time horizons. This is a key consideration when choosing whether to include demographics in a model.", "dependencies": ["starsim"], "test_cases": [{"description": "Result should have both scenario keys", "test": "results = compare_demographics_impact()\nassert set(results.keys()) == {'no_demographics', 'with_demographics'}, 'Should have both scenario keys'"}, {"description": "Each scenario should have final_pop and cum_infections", "test": "results = compare_demographics_impact()\nfor key in ['no_demographics', 'with_demographics']:\n    assert 'final_pop' in results[key], f'{key} should have final_pop'\n    assert 'cum_infections' in results[key], f'{key} should have cum_infections'"}, {"description": "Population should change with demographics but stay roughly constant without", "test": "results = compare_demographics_impact(n_agents=5_000, birth_rate=30, death_rate=10)\nno_demog_pop = results['no_demographics']['final_pop']\nwith_demog_pop = results['with_demographics']['final_pop']\nassert with_demog_pop > no_demog_pop, 'Population with net-positive demographics should be larger than without'"}, {"description": "Both scenarios should produce infections", "test": "results = compare_demographics_impact()\nassert results['no_demographics']['cum_infections'] > 0, 'No-demographics scenario should have infections'\nassert results['with_demographics']['cum_infections'] > 0, 'With-demographics scenario should have infections'"}], "gold_solution": "def compare_demographics_impact(n_agents: int = 5_000, birth_rate: float = 20, death_rate: float = 10, beta: float = 0.05, init_prev: float = 0.01) -> dict[str, dict]:\n    import starsim as ss\n    results = {}\n    # Without demographics\n    sim_no = ss.Sim(\n        n_agents=n_agents,\n        diseases=dict(type='sir', init_prev=init_prev, beta=beta),\n        networks='random',\n        start=2020,\n        stop=2040,\n    )\n    sim_no.run()\n    results['no_demographics'] = {\n        'final_pop': float(sim_no.results.n_alive[-1]),\n        'cum_infections': float(sim_no.results.sir.cum_infections[-1]),\n    }\n    # With demographics\n    sim_yes = ss.Sim(\n        n_agents=n_agents,\n        diseases=dict(type='sir', init_prev=init_prev, beta=beta),\n        networks='random',\n        birth_rate=birth_rate,\n        death_rate=death_rate,\n        start=2020,\n        stop=2040,\n    )\n    sim_yes.run()\n    results['with_demographics'] = {\n        'final_pop': float(sim_yes.results.n_alive[-1]),\n        'cum_infections': float(sim_yes.results.sir.cum_infections[-1]),\n    }\n    return results"}
